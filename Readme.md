# Design of Decoherence

Decoherence is a tool to end the coherence state of backups. Most backups are in a state of coherence like Schrödingers cat. Nobody knows if the backup is correct and recoverable until you need it.  The so called "Schrödingers Backup". Most modern backup solutions provide a way to selftest the archives by some sort of checksums. However these selftests do not check if the restored backup is equal to the source. Or the restore process itself works. `decoherence` aims to be a missing tool in the backup restore fire drill process.
To compare a backup to the source there will be two commands:
* `decoherence record`: This reads the complete backup source. It saves checksums of the files content and meta-data like file attributes to a file database.
* `decoherence check`: Reads the file database generated by `decoherence record`. Compares the database with a local restore of your backup.

The planned workflow is the following:
1. Create a backup
2. Run `decoherence record --store=old.json`
3. Restore the backup somewhere
4. Run `decoherence record --store=new.json` 
4. Run `decoherence check --expected=old.json --got=new.json`

Since `decoherence check` runs on the given database files, you can run the steps 1+2 in your regular backup process.
The steps 3-5 are run at your e.g. monthly backup restore drill. 

## Capabilities of Decoherence Check

The check command should find the following differences between the restored backup and the source:
* The file checksum has changed
* The file attributes (Owner, mode) has changed
* A file is missing

## State of `decoherence`
Currently `decoherence` is in an early alpha state. Feedback is welcome.